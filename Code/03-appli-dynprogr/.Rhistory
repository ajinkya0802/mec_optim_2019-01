cbind(1:2,1)
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
u_xyt
c(kronecker(beta^(1:nbT),cbind(-5E2*(1:nbX),-C))
)
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
c(kronecker(beta^(1:nbT),cbind(-5E2*(1:nbX),-overhaulCost))
)
tst=c(kronecker(beta^(1:nbT),cbind(-5E2*(1:nbX),-overhaulCost)))
sum((tst-u_xyt)^2)
u_xyt
tst
tst-u_xyt
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
tst-u_xyt
eye(3)
diagonal(1,3)
Diagonal(1:3)
diagonal(1:3)
diag(1:3)
N = rbind(cbind(1:(nbT-1),diag(1:(nbT-1))),1:nbT0
N = rbind(cbind(1:(nbT-1),diag(1:(nbT-1))),1:nbT)
kronecker(diag(1:nbT),matrix(1,nbY,1),diag(1:nbX))
kronecker(diag(1:nbT),matrix(1,nbY,1))
A = kronecker(kronecker(diag(1:nbT),matrix(1,nbY,1)),diag(1:nbX) )
P_xy_xpr = matrix(P_x_y_xpr,nrow=nbX)
A = kronecker(kronecker(diag(1:nbT),matrix(1,nbY,1)),diag(1:nbX) ) - kronecker(N,P_xy_xpr)
kronecker(N,P_xy_xpr)
dim(kronecker(N,P_xy_xpr))
dim(kronecker(kronecker(diag(1:nbT),matrix(1,nbY,1)),diag(1:nbX) ))
dim(N)
nbY
nbX
P_xy_xpr = matrix(P_x_y_xpr,ncol=nbX)
A = kronecker(kronecker(diag(1:nbT),matrix(1,nbY,1)),diag(1:nbX) ) - kronecker(N,P_xy_xpr)
Atest = kronecker(kronecker(diag(1:nbT),matrix(1,nbY,1)),diag(1:nbX) ) - kronecker(N,P_xy_xpr)
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
sum((Atest-A)*(Atest-A))
c(Atest-A)
old=kronecker( sparseMatrix(x=1,1:nbT,1:nbT), matrix(I_x_y_xpr, ncol = nbX) )
new= kronecker(kronecker(diag(1:nbT),matrix(1,nbY,1)),diag(1:nbX) )
sum((old-new)^2)
new=kronecker(matrix(1,nbY,1),diag(1:nbX))
old=matrix(I_x_y_xpr, ncol = nbX)
sum((old-new)^2)
matrix(I_x_y_xpr, ncol = nbX)
old
new
Atest = kronecker(kronecker(diag(nbT),matrix(1,nbY,1)),diag(nbX) ) - kronecker(N,P_xy_xpr)
sum(abs(Atest-A))
N = rbind(cbind(rep(1,nbT-1),diag(nbT-1)),rep(1,nbT))
Atest = kronecker(kronecker(diag(nbT),matrix(1,nbY,1)),diag(nbX) ) - kronecker(N,P_xy_xpr)
sum(abs(Atest-A))
old = kronecker(N,P_xy_xpr)
new = kronecker(N,P_xy_xpr)
old=matrix(I_x_y_xpr, ncol = nbX)
sum(abs(old-new))
sum(abs(P_xy_xpr-matrix(I_x_y_xpr, ncol = nbX) ))
matrix(I_x_y_xpr, ncol = nbX) )
old=matrix(I_x_y_xpr, ncol = nbX)
new = kronecker(matrix(1,nbY,1),diag(nbX) )
sum(abs(old-new))
old=kronecker( sparseMatrix(x=1,1:nbT,1:nbT), matrix(I_x_y_xpr, ncol = nbX) )
new = kronecker(diag(nbT),kronecker(matrix(1,nbY,1),diag(nbX) ))
sum(abs(old-new))
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
S
A
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
Atest = kronecker(kronecker(diag(nbT),matrix(1,nbY,1)),diag(nbX) ) - kronecker(N,P_xy_xpr)
new = - kronecker(N,P_xy_xpr)
sum(abs(old-new))
sum(abs(old+new))
N = rbind(cbind(rep(1,nbT-1),diag(nbT-1)),rep(1,nbT))
sum(abs(matrix(P_x_y_xpr, ncol = nbX) - P_xy_xpr))
N = rbind(cbind(rep(0,nbT-1),diag(nbT-1)),rep(0,nbT))
Atest = kronecker(kronecker(diag(nbT),matrix(1,nbY,1)),diag(nbX) ) - kronecker(N,P_xy_xpr)
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
sum(abs(A-Atest))
sparseMatrix(1:2,2:3)
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
IdT = sparseMatrix(1:nbT,1:nbT)
IdX = sparseMatrix(1:nbX,1:nbX)
N = sparseMatrix(1:(nbT-1),2:nbT)
A = kronecker(kronecker(IdT,matrix(1,nbY,1)),IdX ) - kronecker(N,P_xy_xpr)
dim(IdT)
dim(N)
N = sparseMatrix(1:(nbT-1),2:nbT,dims = c(nbT,nbT))
A = kronecker(kronecker(IdT,matrix(1,nbY,1)),IdX ) - kronecker(N,P_xy_xpr)
dim(N)
dim(kronecker(N,P_xy_xpr))
dim(kronecker(kronecker(IdT,matrix(1,nbY,1)),IdX ) )
P_xy_xpr = matrix(P_x_y_xpr,ncol=nbX)
IdT = sparseMatrix(1:nbT,1:nbT)
IdX = sparseMatrix(1:nbX,1:nbX)
N = sparseMatrix(1:(nbT-1),2:nbT,dims = c(nbT,nbT))
A = kronecker(kronecker(IdT,matrix(1,nbY,1)),IdX ) - kronecker(N,P_xy_xpr)
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
u_x_y
tst=c(kronecker(beta^(1:nbT),u_x_y)
)
sum(abs(u_xyt-tst))
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
sum(abs(u_xyt-tst))
beta^(1:3)
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
sum(abs(u_xyt-tst))
tst=c(kronecker(matrix(beta^(1:nbT),nbT,1),u_x_y)
tst=c(kronecker(matrix(beta^(1:nbT),nbT,1),u_x_y))
sum(abs(u_xyt-tst))
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
sum(abs(u_xyt-tst))
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
matrix(beta^(1:nbT),nbT,1)
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
sum(abs(u_xyt-tst))
(u_xyt-tst)[1:20]
nbX
tst=c(kronecker(matrix(beta^(1:nbT),nbT,1),c(u_x_y)))
sum(abs(u_xyt-tst))
tst=c(kronecker(beta^(1:nbT),c(u_x_y)))
sum(abs(u_xyt-tst))
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
source('C:/Users/Alfred/Dropbox/AGResearch_in_progress/_Course_2018_NYU-Matching_Models_and_their_Applications/_applications/block03/busmaintenance.R')
library('Matrix')
IdX = sparseMatrix(1:nbX,1:nbX)
library('Matrix')
library('gurobi')
nbX = 10 #30
nbT = 40 #40
nbY = 2 # choice set: 1=run as usual; 2=overhaul
IdX = sparseMatrix(1:nbX,1:nbX)
LX=sparseMatrix(c(nbX,1:(nbX-1)),1:nbX)
RX=sparseMatrix(1:nbX,rep(1,nbX),dims=c(nbX,nbX))
P=kronecker(c(1,0),0.75*IdX+0.25*LX)+kronecker(c(0,1),RX)
IdT = sparseMatrix(1:nbT,1:nbT)
NT = sparseMatrix(1:(nbT-1),2:nbT,dims = c(nbT,nbT))
A = kronecker(kronecker(IdT,matrix(1,nbY,1)),IdX ) - kronecker(NT,P)
overhaulCost = 8E3
maintCost = function(x)(x*5E2)
beta = 0.9
n1_x = rep(1,nbX)
b_xt = c(n1_x,rep(0,nbX*(nbT-1)))
u_xy = c(-maintCost(1:(nbX-1)),rep(-overhaulCost,nbX+1))
u_xyt = c(kronecker(beta^(1:nbT),u_xy))
result   = gurobi ( list(A=A,obj=c(b_xt),modelsense="min",rhs=u_xyt,sense=">",lb=-Inf), params=list(OutputFlag=0) )
result$status
str(result)
nbX*nbY*nbT
